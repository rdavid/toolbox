#!/bin/sh
# vi:et lbr noet sw=2 ts=2 tw=79 wrap
# Copyright 2022-2023 David Rabkin
readonly REL=0.9.20230212
readonly \
	DST=/usr/local/bin \
	SRC=https://github.com/rdavid/shellbase/archive/refs/tags/v$REL.tar.gz
	TGT=/usr/local/bin/base.sh

# Starting point.
command -v curl >/dev/null 2>&1 || { printf >&2 Install\ curl.\\n; exit 12;}
command -v tar >/dev/null 2>&1 || { printf >&2 Install\ tar.\\n; exit 13;}

# Uses Unix shell framework shellbase:
#  https://github.com/rdavid/shellbase/
eval "$(
	curl --location --silent $SRC |
		tar \
			--extract \
			--gzip \
			--to-stdout \
			shellbase-$REL/lib/base.sh
)"
is_writable $DST || die $DST is not writable.
file_exists $TGT &&
	yes_to_continue \
		"$(sh $TGT --quiet --version)" \
		is installed. Install \
		"$BASE_VERSION"?
curl --location --silent $SRC |
	tar \
		--directory $DST \
		--extract \
		--gzip \
		--strip-components=2 \
		shellbase-$REL/lib/base.sh ||
	die Unable to install shellbase to $DST.
printf \
	'%s is installed to %s.\n' \
	"$(sh $TGT --quiet --version)" \
	$DST
